# Probability--Card-Game--Ride-The-Bus (In-Progress)

## Introduction

This project focuses on the final phase of the card game, aka when a player "rides the bus". I took an interest to this part of the game because it can be modeled as a Monte Carlo problem, and honestly I just thought it would be cool to do that. I use simulation to find the probability of correctly guessing all card properties in sequence on the first try. If you'd like more information about the game, please see the bottom of this READ.me for a brief description. 

-----

### Assumptions of the problem:
- **Deck model:** Standard 52-card deck, no jokers, fair shuffle. Therefore, assume a finite probability space generated by a uniformly-shuffled standard deck of 52 cards.
  - **Sampling Without Replacement**: Draws that have already been made can not occur a second time. There is also no replacement/reshuffling between guesses.
  - **No Foresight:** Player cannot see future cards. They are limited to the information given by the cards that are currently on the table.
  - **Order Matters**: Guesses for events $B,C,D$ condition on all previously revealed cards ($X_1,X_2,X_3$). Assume that the player knows and uses this information.
- **Numbering the Ranks:** Using graph theory, map the rank of each card to a set of numbers {1,...,13}.
    - **Assume the value of Ace is 1.** 
- **Independence:** Assume trials are IID (independent and identically distributed). However, within each trial, events are **not independent** and they are evaluated via the chain rule.

**A Note on The Bayesian/Chain Structure.**  
Following what I wrote in the Independence assumption, the joint success probability uses the chain rule:

$$\mathbb{P}(A\cap B\cap C\cap D)
=\mathbb{P}(A)\ \cdot \mathbb{P}(B\mid A)\ \cdot  \mathbb{P}(C\mid A,B)\ \cdot \mathbb{P}(D\mid A,B,C).$$

Operationally, each conditional is realized by conditioning on the (already revealed) cards and the strategy used at that step.

-----
### Defining the Events and Order:
Define the event set $$\mathcal{E}=\{A,B,C,D\}$$ with the required temporal order $$\(A \prec B \prec C \prec D\)$$. Each event is “the guess for that round is correct,” based on information available up to that round:
- \(A\): Correctly guess **Red vs. Black** for $$\(X_1\)$$.
- \(B\): Correctly guess **Higher vs. Lower** for $$\(X_2\)$$, given $$\(X_1\)$$.
- \(C\): Correctly guess **In-between vs. Outside** for $$\(X_3\)$$, given $$\(X_1,X_2\)$$.
- \(D\): Correctly guess **Suit** for $$\(X_4\)$$, given $$\(X_1,X_2,X_3\)$$.

-----

### Defining the Strategies (for Optimal Guess):
- $A$: Red/black always has a 50\% success rate (By the uniformity and symmetry of the Deck Model assumption). Choose the guess with a bernoulli distribution (with p=0.5) since you might as as well just flip a coin.
- $B$: Guess “higher” if more higher cards remain, guess “lower” if more lower remain. A tie will be broken uniformly.
  - **NOTE: Equals count as incorrect.**
- $C$: Guess “between” if more remaining cards lie strictly between $r_{\min},r_{\max}$, else guess “outside”. A tie will be broken uniformly.
  - **NOTE: Endpoints will count as outside**.
- $D$: Guess the modal remaining suite. This is a greedy strategy. Look at the remaining 49 cards, guess the suit with the highest remaining frequency (the mode).
  - While the impact of this is often inconsequential to the result, it is an extra step that I honestly did for fun just to squeeze out more accuracy by continuing to condition on the given information.
  - *Exploring the Extreme Case:* All three cards drawn from events A, B, and C have the same suit. There is a 22/425 (~5.176\%) probability of this happening. However, if it does happen, then we already know 3 cards (23\%) of that suit are already on the table. Thus, we know that we have 10 of those cards left in the remaining deck (which can be reformulated such that 10/49=~20.41\% are the same suit as what's on the table). We also know that the other three suits each make up 13/49(~26.53\%). This proves that guessing one of the three suits that have 13 cards still left in the main deck will beat a uniform (1/4=25%) guess -- and WILL DEFINITELY beat guessing the depleted suit.
 
- **Outcome definition to Calculate the Joint Probability** To estimate $P(A\cap B\cap C\cap D)$ for **one pass** (aka, the “first try”) of four guesses, use an indicator of sequential success such that $\mathbf{1}_{ABCD}=\mathbf{1}_A\mathbf{1}_B\mathbf{1}_C\mathbf{1}_D$.

-----

### Write-up: A Walk-through of the Logic Used in Each Part of the Simulation Code

**1) Deck construction and randomization.**  
Construct ranks $$(1{:}13)$$, suits $$\(\{S,H,D,C\}\)$$, and colors $$\(\{\text{black},\text{red}\}\)$$; generate a random permutation `deck_idx` to represent the shuffled deck.

**2) Event $$\(A\)$$: Red/Black (uses no prior card info).**  
- Observe color of $$\(X_1\)$$.  
- Guess uniformly at random between “red” and “black”.  
- Record $$\[\mathbf{1}_A = \mathbb{I}\{\text{guess matches color}(X_1)\}\]$$.
- *Note:* This will always have a probability of $$\( \tfrac{1}{2} \)$$ since we assume that the deck is a full, standard deck at the start.

**3) Event $$\(B\)$$: Higher/Lower (conditions on $$\(X_1\)$$).**  
- With $$r_1=\text{rank}(X_1)$$, compute counts of strictly higher and strictly lower ranks remaining.  
- Choose the **optimal** direction (“higher” if more higher cards remain; “lower” otherwise; break ties at random).  
- Reveal $$\(X_2\)$$ and record $$\[\mathbf{1}_B = \mathbb{I}\{\text{direction matches }(r_2 \gtrless r_1)\}\]$$.

**4) Event $$\(C\)$$: In-between/Outside (conditions on $$\(X_1,X_2\)$$).**  
- With $$r_{\min}=\min(r_1,r_2)$$ and $$r_{\max}=\max(r_1,r_2)$$, count remaining ranks strictly between vs. outside/equal.  
- Choose the **higher-probability** option (“between” if between-count > outside-count; else “outside”; break ties at random).  
- Reveal $$\(X_3\)$$ and record $$\[\mathbf{1}_C = \mathbb{I} \{\text{such that the guess matches position of }r_3\}\]$$.

**5) Event $$\(D\)$$: Suit (conditions on $$\(X_1,X_2,X_3\)$$).**  
- From the 49 remaining cards, compute the remaining suit frequencies.  
- (Method permits either a uniform suit guess or a **greedy** guess of the modal remaining suit.)  
- Reveal $$\(X_4\)$$ and record $$\[\mathbf{1}_D = \mathbb{I}\{\text{such that the guess matches suit}(X_4)\}\]$$.

**6) Estimating the joint probability.**  
Run $$N$$ number of independent simulations. For each run, compute the indicator of sequential success. I used an indicator variable because whether or not all events were guessed correctly is a true or false outcome -- Thus, suiting the defintion of the random variable. By this logic, we can preserve the binary nature of the problem when moving to calculate the joint probability of the events. This can be formulated mathematically as follows:

$$
\mathbf{1}_{ABCD}=\mathbf{1}_A\mathbf{1}_B\mathbf{1}_C\mathbf{1}_D\
$$

...and from this we can estimate...

$$\widehat{\mathbb{P}}(A\cap B\cap C\cap D)=\frac{1}{N}\sum_{i=1}^N \mathbf{1}_{ABCD}^{(i)}$$



--------
--------

*Full Game Description: Summarized using ChatGPT from [Thrillist](https://www.thrillist.com/culture/ride-the-bus-drinking-game)*

Ride the Bus is a (drinking) card game played in three phases. In the first phase, each player is dealt four cards one at a time, guessing each card’s property in sequence: red or black, higher or lower than the first card, between or outside the first two cards, and finally the suit. Wrong guesses mean drinks; right guesses in the final round let you assign drinks to others. In phase two, the dealer builds a pyramid of face-down cards (five at the base up to one at the top), flipping them row by row. If a card matches one in your hand, you can play it and assign drinks—the higher the row, the more drinks. Players try to use their cards strategically to avoid being left with too many. In the final phase, the player with the most remaining cards “rides the bus” by guessing card properties in sequence (often starting with red or black) for a set number of cards; any wrong guess forces them to drink and restart from the beginning, making it the most punishing part of the game.

*Disclaimer: This project is not meant to encourage drinking.*
